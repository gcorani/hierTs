#determines the value of sigma12 in order to obtain the desired correlation between B1 and U
get_rho12_numerical <- function (phi, corB1_U) {
#we assume everywhere noise with variance 1
inv_sigmaB1 <- sqrt(1 - phi[1]^2)
a <- 1/(1-phi[1]^2)
b <- 1 - prod(phi)
c <- 1/(1-phi[1]^2)
d <- 1/(1-phi[2]^2)
#range is +-1 becasue we are talking about a correlation
inverse = function (f, lower = -1, upper = 1) {
function (y) uniroot((function (x) f(x) - y), lower = lower, upper = upper)[1]
}
correl_inverse = inverse(function (x) inv_sigmaB1 * (a + x/(1-prod(phi))) *
1/(sqrt(c + d + 2 * x/b)) )
rho12 = correl_inverse(corB1_U)
return(rho12)
}
source('~/switchDrive/paperReconc/hierTsCode/draw_arima.R', echo=TRUE)
get_rho12_numerical(phi,correl)
get_rho12_exact(phi,correl)
phi <- runif(howMany)
howMany <- 2
phi <- runif(howMany)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12 <- as.numeric(get_rho12(phi=phi, corB1_U = correl))
sigma_e12
source('~/switchDrive/paperReconc/hierTsCode/draw_arima.R')
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12")
print(c(sigma_e12_numerical, sigma_e12_exact))
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12")
print(c(sigma_e12_numerical, sigma_e12_exact))
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12")
print(c(sigma_e12_numerical, sigma_e12_exact))
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12")
print(c(sigma_e12_numerical, sigma_e12_exact))
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12")
print(c(sigma_e12_numerical, sigma_e12_exact))
source('~/switchDrive/paperReconc/hierTsCode/draw_arima.R')
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12 exact")
print(sigma_e12_exact)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
print("sigma12 numerical")
print(sigma_e12_numerical)
phi <- c(0.8557160, 0.4759437)
phi
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_exact <- get_rho12_exact(phi, correl)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
print("sigma12 numerical")
print(sigma_e12_numerical)
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12 exact")
print(sigma_e12_exact)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
print("sigma12 numerical")
print(sigma_e12_numerical)
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12 exact")
print(sigma_e12_exact)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
print("sigma12 numerical")
print(sigma_e12_numerical)
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12 exact")
print(sigma_e12_exact)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
print("sigma12 numerical")
print(sigma_e12_numerical)
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12 exact")
print(sigma_e12_exact)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_exact <- get_rho12_exact(phi, correl)
sigma_e12_numerical
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
print("sigma12 numerical")
print(sigma_e12_numerical)
phi
corB1_U
corB1_U <- correl
corB1_U
a <- -1 * (1 - corB1_U^2) / (1-prod(phi))
a
b <- (1 - corB1_U^2)^2 / (1-prod(phi))^2
b
c <- (1-phi[1]^2)/(1-prod(phi))^2
c
d <- 1/(1-phi[1]^2) * (1-corB1_U^2) - corB1_U^2 * 1/(1-phi[2]^2)
d
sqrt (b - c * d)
(b - c * d)
phi
phi[2] <- phi[1]
get_rho12_exact(phi, corB1_U )
phi <- v
phi <- 0.8358418
phi
phi <- c(0.8358418, 0.8358418)
get_rho12_exact(phi, corB1_U )
phi <- c(0.7, 0.7)
get_rho12_exact(phi, corB1_U )
get_rho12_numerical(phi, corB1_U )
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12 exact")
print(sigma_e12_exact)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
print("sigma12 numerical")
print(sigma_e12_numerical)
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12 exact")
print(sigma_e12_exact)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
print("sigma12 numerical")
print(sigma_e12_numerical)
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12 exact")
print(sigma_e12_exact)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
print("sigma12 numerical")
print(sigma_e12_numerical)
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12 exact")
print(sigma_e12_exact)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
print("sigma12 numerical")
print(sigma_e12_numerical)
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12 exact")
print(sigma_e12_exact)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
print("sigma12 numerical")
print(sigma_e12_numerical)
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12 exact")
print(sigma_e12_exact)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
print("sigma12 numerical")
print(sigma_e12_numerical)
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12 exact")
print(sigma_e12_exact)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
print("sigma12 numerical")
print(sigma_e12_numerical)
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12 exact")
print(sigma_e12_exact)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
print("sigma12 numerical")
print(sigma_e12_numerical)
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12 exact")
print(sigma_e12_exact)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
print("sigma12 numerical")
print(sigma_e12_numerical)
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12 exact")
print(sigma_e12_exact)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
print("sigma12 numerical")
print(sigma_e12_numerical)
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12 exact")
print(sigma_e12_exact)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
print("sigma12 numerical")
print(sigma_e12_numerical)
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12 exact")
print(sigma_e12_exact)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
print("sigma12 numerical")
print(sigma_e12_numerical)
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12 exact")
print(sigma_e12_exact)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
print("sigma12 numerical")
print(sigma_e12_numerical)
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12 exact")
print(sigma_e12_exact)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
print("sigma12 numerical")
print(sigma_e12_numerical)
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12 exact")
print(sigma_e12_exact)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
print("sigma12 numerical")
print(sigma_e12_numerical)
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12 exact")
print(sigma_e12_exact)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
print("sigma12 numerical")
print(sigma_e12_numerical)
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12 exact")
print(sigma_e12_exact)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
print("sigma12 numerical")
print(sigma_e12_numerical)
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12 exact")
print(sigma_e12_exact)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
print("sigma12 numerical")
print(sigma_e12_numerical)
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12 exact")
print(sigma_e12_exact)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
print("sigma12 numerical")
print(sigma_e12_numerical)
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12 exact")
print(sigma_e12_exact)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
print("sigma12 numerical")
print(sigma_e12_numerical)
phi <- runif(howMany)
print("phi")
print(phi)
#covariance of the noise of the two bottom time series(it is also a correlation as we assume the noise
# to have variance 1)
sigma_e12_exact <- get_rho12_exact(phi, correl)
print("sigma12 exact")
print(sigma_e12_exact)
sigma_e12_numerical <- get_rho12_numerical(phi, correl)
print("sigma12 numerical")
print(sigma_e12_numerical)
source('~/switchDrive/paperReconc/hierTsCode/draw_arima.R')
0:1:0.005
?seq
seq(from=0.001,to=0.999, by = 0.05)
source('~/switchDrive/paperReconc/hierTsCode/draw_arima.R')
correl = 0.5
rows <- length(seq(from=0.001,to=0.999, by = 0.05))
sigmaMat <- matrix(nrow = rows, ncol = rows)
k=1
l=1
for (i in (seq(from=0.001,to=0.999, by = 0.05))) {
for (j in (seq(from=0.001,to=0.999, by = 0.05))) {
sigmaMat[k,l] <- get_rho12_exact(phi=c(i,j), correl)[1]
k= k +1
}
l = l + 1
}
sigmaMat
source('~/switchDrive/paperReconc/hierTsCode/draw_arima.R')
k=1
l=1
for (i in (seq(from=0.001,to=0.999, by = 0.05))) {
for (j in (seq(from=0.001,to=0.999, by = 0.05))) {
sigmaMat[k,l] <- get_rho12_exact(phi=c(i,j), correl)[1]
k= k +1
}
k = 1
l = l + 1
}
sigmaMat
View(sigmaMat)
source('~/switchDrive/paperReconc/hierTsCode/draw_arima.R')
rownames(sigmaMat) <- seq(from=0.001,to=0.999, by = 0.05)
View(sigmaMat)
rownames(sigmaMat) <- seq(from=0.001,to=0.999, by = 0.05)
colnames(sigmaMat) <- seq(from=0.001,to=0.999, by = 0.05)
source('~/switchDrive/paperReconc/hierTsCode/draw_arima.R')
View(sigmaMat)
sigmaMatCor05 <- sigmaMat
source('~/switchDrive/paperReconc/hierTsCode/draw_arima.R')
correl = 0.9
rows <- length(seq(from=0.001,to=0.999, by = 0.05))
sigmaMat <- matrix(nrow = rows, ncol = rows)
k=1
l=1
for (i in (seq(from=0.001,to=0.999, by = 0.05))) {
for (j in (seq(from=0.001,to=0.999, by = 0.05))) {
sigmaMat[k,l] <- get_rho12_exact(phi=c(i,j), correl)[1]
k= k +1
}
k = 1
l = l + 1
}
rownames(sigmaMat) <- seq(from=0.001,to=0.999, by = 0.05)
colnames(sigmaMat) <- seq(from=0.001,to=0.999, by = 0.05)
View(sigmaMat)
source('~/switchDrive/paperReconc/hierTsCode/draw_arima.R')
correl = 0.1
rows <- length(seq(from=0.001,to=0.999, by = 0.05))
sigmaMat <- matrix(nrow = rows, ncol = rows)
k=1
l=1
for (i in (seq(from=0.001,to=0.999, by = 0.05))) {
for (j in (seq(from=0.001,to=0.999, by = 0.05))) {
sigmaMat[k,l] <- get_rho12_exact(phi=c(i,j), correl)[1]
k= k +1
}
k = 1
l = l + 1
}
rownames(sigmaMat) <- seq(from=0.001,to=0.999, by = 0.05)
colnames(sigmaMat) <- seq(from=0.001,to=0.999, by = 0.05)
View(sigmaMat)
source('~/switchDrive/paperReconc/hierTsCode/draw_arima.R')
correl = 0.01
rows <- length(seq(from=0.001,to=0.999, by = 0.05))
sigmaMat <- matrix(nrow = rows, ncol = rows)
k=1
l=1
for (i in (seq(from=0.001,to=0.999, by = 0.05))) {
for (j in (seq(from=0.001,to=0.999, by = 0.05))) {
sigmaMat[k,l] <- get_rho12_exact(phi=c(i,j), correl)[1]
k= k +1
}
k = 1
l = l + 1
}
rownames(sigmaMat) <- seq(from=0.001,to=0.999, by = 0.05)
colnames(sigmaMat) <- seq(from=0.001,to=0.999, by = 0.05)
source('~/switchDrive/paperReconc/hierTsCode/draw_arima.R')
runif
?runif
source('~/switchDrive/paperReconc/hierTsCode/draw_arima.R')
correl = 0.01
rows <- length(seq(from=-0.999,to=0.999, by = 0.05))
sigmaMat <- matrix(nrow = rows, ncol = rows)
k=1
l=1
for (i in (seq(from=-0.999,to=0.999, by = 0.05))) {
for (j in (seq(from=-0.999,to=0.999, by = 0.05))) {
sigmaMat[k,l] <- get_rho12_exact(phi=c(i,j), correl)[1]
k= k +1
}
k = 1
l = l + 1
}
rownames(sigmaMat) <- seq(from=-0.999,to=0.999, by = 0.05)
colnames(sigmaMat) <- seq(from=-0.999,to=0.999, by = 0.05)
View(sigmaMat)
