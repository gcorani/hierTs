if (length(upperIdx)==1){
A <- cbind(S[upperIdx,])
}
debugSource('~/switchDrive/paperReconc/hierarchicalTimeSeries/code/hierTs/hierRec.R')
hierRec(dset="synthetic", synthCorrel =  0.5, synth_n =100)
mseBayes
mseBayesCorr
mseBase
mseCombMint
source('~/switchDrive/paperReconc/hierarchicalTimeSeries/code/hierTs/hierRec.R')
hierRec(dset="infantgts")
hierRec(dset="synthetic", synthCorrel = 0.5, synth_n = 100)
?out.glasso
library(huge)
?out.glasso
?huge
?huge.select
source('~/switchDrive/paperReconc/hierarchicalTimeSeries/code/hierTs/hierRec.R')
hierRec(dset="synthetic", synthCorrel = 0.5, synth_n = 100)
hierRec(dset="infantgts")
source('~/switchDrive/paperReconc/hierarchicalTimeSeries/code/hierTs/hierRec.R')
hierRec(dset="infantgts")
source('~/switchDrive/paperReconc/hierarchicalTimeSeries/code/hierTs/batchSynthetic.R')
batchSynthetic()
size <- c(20,200)
for (currentSize in size) {
print(paste("currentSize:",currentSize))}
reps <- 100
size <- c(20,200)
correl <- c(0.1, 0.5)
models=c("arima","ets")
set.seed(0)
for (currentSize in size) {
print(paste("currentSize:",currentSize))
for (fmethod in models){
print(paste("method:",fmethod))
for (currentCorr in correl){
print(paste("correlation:",currentCorr))
for (i in (1:reps)){
print(i)
hierRec("synthetic", h=1, fmethod = fmethod, synth_n = currentSize, synthCorrel = currentCorr)
}
source('~/switchDrive/paperReconc/hierarchicalTimeSeries/code/hierTs/hierRec.R')
batchSynthetic()
#parse the results of hierarchical non-temporal reconciliation on synthetic dataa set
#readt the mse, extract the proportion of favorable signs and the produces the boxplot
library(readr)
results <- read_csv(paste("results/mseHierReconcsynthetic.csv"))
results <- unique(results) #because some experiements on the cluster are duplicated
fmethods <- unique(results$fmethod)
?unique
keys <- unique(cbind(results$fmethod, results$synth_n, results$synthCorrel)) #because some experiements on the cluste?r are duplicated
keys
length(keys)
dim(keys)
keys
?unique
source('~/switchDrive/paperReconc/hierarchicalTimeSeries/code/hierTs/parseHierResults_synthetic.R')
keys
for (key in keys){
idx = ( results$fmethod == key[1] &
results$synth_n == key[2] &
results$synthCorrel == key[3] )
subResults <- results[idx,]
}
subResults
keys
keys[1,1]
keys[1,2]
keys[1,3]
results$fmethod == key[1,1]
key
keys
for (key in keys) print(key)
source('~/switchDrive/paperReconc/hierarchicalTimeSeries/code/hierTs/parseHierResults_synthetic.R')
for (i in 1:dim(keys)[1]){
key=keys[i,]
idx = ( results$fmethod == key[1] &
results$synth_n == key[2] &
results$synthCorrel == key[3] )
subResults <- results[idx,]
}
subResults
keys
source('~/switchDrive/paperReconc/hierarchicalTimeSeries/code/hierTs/parseHierResults_synthetic.R')
results <- read_csv(paste("results/mseHierReconcsynthetic.csv"))
keys <- unique(cbind(results$fmethod, results$synth_n, results$synthCorrel)) #because some experiements on the cluste?r are duplicated
configs = dim(keys)[1]
#init the lists of results
summaryEachConfig <- data.frame(
numExperiments=rep(-1,configs),
sampleSize=rep(-1,configs),
fmethod=rep("ets",configs),
bottomCorrelation=rep(-1,configs),
propDiagBeatBase=rep(-1,configs),
propDiagBeatMint=rep(-1,configs),
propCorrBeatBase=rep(-1,configs),
propCorrBeatMint=rep(-1,configs),
medianBaseBayes=rep(-1,configs),
medianBaseBayesCorr=rep(-1,configs),
medianMintBayes=rep(-1,configs),
medianMintBayesCorr=rep(-1,configs),
stringsAsFactors = FALSE
)
for (i in 1:dim(keys)[1]){
key=keys[i,]
idx = ( results$fmethod == key[1] &
results$synth_n == key[2] &
results$synthCorrel == key[3] )
subResults <- results[idx,]
summaryEachConfig$fmethod[i] <- key[1]
}
for (i in 1:dim(keys)[1]){
key=keys[i,]
idx = ( results$fmethod == key[1] &
results$synth_n == key[2] &
results$synthCorrel == key[3] )
subResults <- results[idx,]
summaryEachConfig$fmethod[i] <- key[1]
}
summaryEachConfig
source('~/switchDrive/paperReconc/hierarchicalTimeSeries/code/hierTs/parseHierResults_synthetic.R')
for (i in 1:dim(keys)[1]){
key=keys[i,]
idx = ( results$fmethod == key[1] &
results$synth_n == key[2] &
results$synthCorrel == key[3] )
subResults <- results[idx,]
summaryEachConfig$fmethod[i] <- key[1]
summaryEachConfig$sampleSize[i] <- key[2]
summaryEachConfig$numExperiments[i] <- length(idx)
}
View(summaryEachConfig)
source('~/switchDrive/paperReconc/hierarchicalTimeSeries/code/hierTs/parseHierResults_synthetic.R')
key
source('~/switchDrive/paperReconc/hierarchicalTimeSeries/code/hierTs/parseHierResults_synthetic.R')
for (i in 1:dim(keys)[1]){
key=keys[i,]
idx = ( results$fmethod == key[1] &
results$synth_n == key[2] &
results$synthCorrel == key[3] )
subResults <- results[idx,]
summaryEachConfig$fmethod[i] <- key[1]
summaryEachConfig$sampleSize[i] <- key[2]
summaryEachConfig$numExperiments[i] <- length(idx)
summaryEachConfig$bottomCorrelation[i] <- key[3]
summaryEachConfig$propDiagBeatBase <- mean(subResults$mseBayes<subResults$mseBase)
summaryEachConfig$propCorrBeatBase <- mean(subResults$mseBayesCorr<subResults$mseBase)
summaryEachConfig$propDiagBeatMint <- mean(subResults$mseBayes<subResults$mseCombMint)
summaryEachConfig$propCorrBeatMint <- mean(subResults$mseBayesCorr<subResults$mseCombMint)
}
View(summaryEachConfig)
source('~/switchDrive/paperReconc/hierarchicalTimeSeries/code/hierTs/parseHierResults_synthetic.R')
for (i in 1:dim(keys)[1]){
key=keys[i,]
idx = ( results$fmethod == key[1] &
results$synth_n == key[2] &
results$synthCorrel == key[3] )
subResults <- results[idx,]
summaryEachConfig$fmethod[i] <- key[1]
summaryEachConfig$sampleSize[i] <- key[2]
summaryEachConfig$numExperiments[i] <- length(idx)
summaryEachConfig$bottomCorrelation[i] <- key[3]
summaryEachConfig$propDiagBeatBase[i] <- mean(subResults$mseBayes<subResults$mseBase)
summaryEachConfig$propCorrBeatBase[i] <- mean(subResults$mseBayesCorr<subResults$mseBase)
summaryEachConfig$propDiagBeatMint[i] <- mean(subResults$mseBayes<subResults$mseCombMint)
summaryEachConfig$propCorrBeatMint[i] <- mean(subResults$mseBayesCorr<subResults$mseCombMint)
}
source('~/switchDrive/paperReconc/hierarchicalTimeSeries/code/hierTs/parseHierResults_synthetic.R')
parseHierResults_eachH()
#parse the results of hierarchical non-temporal reconciliation on synthetic dataa set
#readt the mse, extract the proportion of favorable signs and the produces the boxplot
library(readr)
results <- read_csv(paste("results/mseHierReconcsynthetic.csv"))
keys <- unique(cbind(results$fmethod, results$synth_n, results$synthCorrel)) #because some experiements on the cluste?r are duplicated
configs = dim(keys)[1]
#init the lists of results
summaryEachConfig <- data.frame(
numExperiments=rep(-1,configs),
sampleSize=rep(-1,configs),
fmethod=rep("ets",configs),
bottomCorrelation=rep(-1,configs),
propDiagBeatBase=rep(-1,configs),
propDiagBeatMint=rep(-1,configs),
propCorrBeatBase=rep(-1,configs),
propCorrBeatMint=rep(-1,configs),
medianBaseBayes=rep(-1,configs),
medianBaseBayesCorr=rep(-1,configs),
medianMintBayes=rep(-1,configs),
medianMintBayesCorr=rep(-1,configs),
stringsAsFactors = FALSE
)
key
keys
i+1
i=1
key=keys[i,]
idx = ( results$fmethod == key[1] &
results$synth_n == key[2] &
results$synthCorrel == key[3] )
key
subResults <- results[idx,]
subResults
source('~/switchDrive/paperReconc/hierarchicalTimeSeries/code/hierTs/parseHierResults_synthetic.R')
subResults <- results[idx,]
summaryEachConfig$fmethod[i] <- key[1]
summaryEachConfig$sampleSize[i] <- key[2]
summaryEachConfig$numExperiments[i] <- sum(idx)
summaryEachConfig$bottomCorrelation[i] <- key[3]
mean(subResults$mseBayes<subResults$mseBase)
mean(subResults$mseBayes<subResults$mseCombMint)
mean(subResults$mseBayesCorr<subResults$mseCombMint)
summary(subResults$mseBayesCorr/subResults$mseCombMint)
boxplot(log(subResults$mseBayesCorr/subResults$mseCombMint))
abline(0,0)
summary(log(subResults$mseBayesCorr/subResults$mseCombMint))
subResults
length(subResults)
dim(subResults)
summary(log(subResults$mseBayesCorr/subResults$mseCombMint))
source('~/switchDrive/paperReconc/hierarchicalTimeSeries/code/hierTs/parseHierResults_synthetic.R')
parseHierResults_synthetic()
#parse the results of hierarchical non-temporal reconciliation on synthetic dataa set
#readt the mse, extract the proportion of favorable signs and the produces the boxplot
library(readr)
results <- read_csv(paste("results/mseHierReconcsynthetic.csv"))
results
source('~/switchDrive/paperReconc/hierarchicalTimeSeries/code/hierTs/parseHierResults_synthetic.R')
parseHierResults_synthetic()
source('~/switchDrive/paperReconc/hierarchicalTimeSeries/code/hierTs/parseHierResults_synthetic.R')
parseHierResults_synthetic()
source('~/switchDrive/paperReconc/hierarchicalTimeSeries/code/hierTs/parseHierResults_synthetic.R')
debugSource('~/switchDrive/paperReconc/hierarchicalTimeSeries/code/hierTs/hierRec.R')
hierRec("synthetic",synthCorrel = -1)
artificialTs(n=synth_n, correl = synthCorrel, howMany = howManyBottom)
lines(artificialTs(,1))
lines(synhTs)
lines(synthTS)
lines(synthTs)
hierRec("synthetic",synthCorrel = -1)
lines(synthTs)
lines(synthTs[,1])
plot(synthTs[,1])
?plot
corr(synthTs)
cor(synthTs)
cor(cbind(synthTs,apply(synthTs,1,sum)))
hierRec("synthetic", fmethod = "ets", synthCorrel = -0.9, seed=0)
phi
theta
noise
cor(cbind(noise,apply(noise,1,sum)))
noise <- drawNoise(10000, correl, howMany)
cor(cbind(noise,apply(noise,1,sum)))
correl
correl=-1
noise <- drawNoise(10000, correl, howMany)
cor(cbind(noise,apply(noise,1,sum)))
correl=-1.95
noise <- drawNoise(10000, correl, howMany)
correl=-.95
noise <- drawNoise(10000, correl, howMany)
cor(cbind(noise,apply(noise,1,sum)))
correl=.95
noise <- drawNoise(10000, correl, howMany)
cor(cbind(noise,apply(noise,1,sum)))
for (i in 1:10) hierRec("synthetic", fmethod = "ets", synthCorrel = -0.9, seed=i)
hierRec("synthetic", fmethod = "ets", synthCorrel = -0.9, seed=0)
debugSource('~/switchDrive/paperReconc/hierarchicalTimeSeries/code/hierTs/hierRec.R')
hierRec("synthetic", fmethod = "ets", synthCorrel = -0.9, seed=0)
bayesRecon(correlation=TRUE))
bayesRecon(correlation=TRUE)
Sigma_y
howManyBottom
upperIdx
debugSource('~/switchDrive/paperReconc/hierarchicalTimeSeries/code/hierTs/hierRec.R')
hierRec("synthetic", fmethod = "ets", synthCorrel = -0.9, seed=0)
y
summary(u)
summary(y)
summary(hierTs)
hierTs <- hts(y, bnames = colnames(y), characters = c(1))
hierTs <- hts(y, bnames = colnames(y))
summary(hierTs)
debugSource('~/switchDrive/paperReconc/hierarchicalTimeSeries/code/hierTs/hierRec.R')
hierRec("synthetic", fmethod = "ets", synthCorrel = -0.9, seed=0)
hierTs
correlation
correlation=TRUE
hierRec("synthetic", fmethod = "ets", synthCorrel = -0.9, seed=0)
parseHierResults_synthetic()
source('~/switchDrive/paperReconc/hierarchicalTimeSeries/code/hierTs/parseHierResults_synthetic.R')
parseHierResults_synthetic()
#parse the results of hierarchical non-temporal reconciliation on synthetic dataa set
#readt the mse, extract the proportion of favorable signs and the produces the boxplot
library(readr)
results <- read_csv(paste("results/mseHierReconcsynthetic.csv"))
keys <- unique(cbind(results$fmethod, results$synth_n, results$synthCorrel, results$howManyBottom)) #because some experiements on the cluste?r are duplicated
results <- read_csv(paste("results/mseHierReconcsynthetic.csv"))
parseHierResults_synthetic()
#parse the results of hierarchical non-temporal reconciliation on synthetic dataa set
#readt the mse, extract the proportion of favorable signs and the produces the boxplot
library(readr)
results <- read_csv(paste("results/mseHierReconcsynthetic.csv"))
results
keys <- unique(cbind(results$fmethod, results$synth_n, results$synthCorrel, results$howManyBottom)) #because some experiements on the cluste?r are duplicated
configs = dim(keys)[1]
#init the lists of results
summaryEachConfig <- data.frame(
howManyBottom=rep(-1,configs),
numExperiments=rep(-1,configs),
sampleSize=rep(-1,configs),
fmethod=rep("ets",configs),
bottomCorrelation=rep(-1,configs),
propDiagBeatBase=rep(-1,configs),
propDiagBeatMint=rep(-1,configs),
propCorrBeatBase=rep(-1,configs),
propCorrBeatMint=rep(-1,configs),
medianBaseBayes=rep(-1,configs),
medianBaseBayesCorr=rep(-1,configs),
medianMintBayes=rep(-1,configs),
medianMintBayesCorr=rep(-1,configs),
stringsAsFactors = FALSE
)
i=1
key=keys[i,]
idx = ( results$fmethod == key[1] &
results$synth_n == key[2] &
results$synthCorrel == key[3] &
results$howManyBottom == key[4])
idx
subResults <- results[idx,]
subResults
summaryEachConfig$fmethod[i] <- key[1]
summaryEachConfig$sampleSize[i] <- key[2]
summaryEachConfig$numExperiments[i] <- sum(idx)
summaryEachConfig$bottomCorrelation[i] <- key[3]
summaryEachConfig$howManyBottom[i] <- key[4]
View(results)
View(subResults)
subResults
source('~/switchDrive/paperReconc/hierarchicalTimeSeries/code/hierTs/parseHierResults_synthetic.R', echo=TRUE)
#parse the results of hierarchical non-temporal reconciliation on synthetic dataa set
#readt the mse, extract the proportion of favorable signs and the produces the boxplot
library(readr)
results <- read_csv(paste("results/mseHierReconcsynthetic.csv"))
keys <- unique(cbind(results$fmethod, results$synth_n, results$synthCorrel, results$howManyBottom)) #because some experiements on the cluste?r are duplicated
configs = dim(keys)[1]
#init the lists of results
summaryEachConfig <- data.frame(
howManyBottom=rep(-1,configs),
numExperiments=rep(-1,configs),
sampleSize=rep(-1,configs),
fmethod=rep("ets",configs),
bottomCorrelation=rep(-1,configs),
propDiagBeatBase=rep(-1,configs),
propDiagBeatMint=rep(-1,configs),
propCorrBeatBase=rep(-1,configs),
propCorrBeatMint=rep(-1,configs),
medianBaseBayes=rep(-1,configs),
medianBaseBayesCorr=rep(-1,configs),
medianMintBayes=rep(-1,configs),
medianMintBayesCorr=rep(-1,configs),
stringsAsFactors = FALSE
)
for (i in 1:dim(keys)[1]){
key=keys[i,]
idx = ( results$fmethod == key[1] &
results$synth_n == key[2] &
results$synthCorrel == key[3] &
results$howManyBottom == key[4])
subResults <- results[idx,]
summaryEachConfig$fmethod[i] <- key[1]
summaryEachConfig$sampleSize[i] <- key[2]
summaryEachConfig$numExperiments[i] <- sum(idx)
summaryEachConfig$bottomCorrelation[i] <- key[3]
summaryEachConfig$howManyBottom[i] <- key[4]
summaryEachConfig$propDiagBeatBase[i] <- mean(subResults$mseBayes<subResults$mseBase)
summaryEachConfig$propCorrBeatBase[i] <- mean(subResults$mseBayesCorr<subResults$mseBase)
summaryEachConfig$propDiagBeatMint[i] <- mean(subResults$mseBayes<subResults$mseCombMint)
summaryEachConfig$propCorrBeatMint[i] <- mean(subResults$mseBayesCorr<subResults$mseCombMint)
summaryEachConfig$medianBaseBayes[i] <- median(subResults$mseBase/subResults$mseBayes)
summaryEachConfig$medianBaseBayesCorr[i] <- median(subResults$mseBase/subResults$mseBayesCorr)
summaryEachConfig$medianMintBayes[i] <- median(subResults$mseCombMint/subResults$mseBayes)
summaryEachConfig$medianMintBayesCorr[i] <- median(subResults$mseCombMint/subResults$mseBayesCorr)
}
summaryEachConfig
options(digits=2)
filename = paste("results/summarySynthetic.csv")
write.table(summaryEachConfig,file=filename,sep=",",row.names = FALSE)
return (summaryEachConfig)
#parse the results of hierarchical non-temporal reconciliation on synthetic dataa set
#readt the mse, extract the proportion of favorable signs and the produces the boxplot
library(readr)
results <- read_csv(paste("results/mseHierReconcsynthetic.csv"))
keys <- unique(cbind(results$fmethod, results$synth_n, results$synthCorrel, results$howManyBottom)) #because some experiements on the cluste?r are duplicated
configs = dim(keys)[1]
#init the lists of results
summaryEachConfig <- data.frame(
howManyBottom=rep(-1,configs),
numExperiments=rep(-1,configs),
sampleSize=rep(-1,configs),
fmethod=rep("ets",configs),
bottomCorrelation=rep(-1,configs),
propDiagBeatBase=rep(-1,configs),
propDiagBeatMint=rep(-1,configs),
propCorrBeatBase=rep(-1,configs),
propCorrBeatMint=rep(-1,configs),
medianBaseBayes=rep(-1,configs),
medianBaseBayesCorr=rep(-1,configs),
medianMintBayes=rep(-1,configs),
medianMintBayesCorr=rep(-1,configs),
stringsAsFactors = FALSE
)
keys
i<-14
key=keys[i,]
idx = ( results$fmethod == key[1] &
results$synth_n == key[2] &
results$synthCorrel == key[3] &
results$howManyBottom == key[4])
key
sum(idx)
subResults <- results[idx,]
summaryEachConfig$fmethod[i] <- key[1]
summaryEachConfig$sampleSize[i] <- key[2]
summaryEachConfig$numExperiments[i] <- sum(idx)
summaryEachConfig$bottomCorrelation[i] <- key[3]
summaryEachConfig$howManyBottom[i] <- key[4]
summaryEachConfig$propDiagBeatBase[i] <- mean(subResults$mseBayes<subResults$mseBase)
summaryEachConfig$propCorrBeatBase[i] <- mean(subResults$mseBayesCorr<subResults$mseBase)
summaryEachConfig$propDiagBeatMint[i] <- mean(subResults$mseBayes<subResults$mseCombMint)
summaryEachConfig$propCorrBeatMint[i] <- mean(subResults$mseBayesCorr<subResults$mseCombMint)
summaryEachConfig$medianBaseBayes[i] <- median(subResults$mseBase/subResults$mseBayes)
summaryEachConfig$medianBaseBayesCorr[i] <- median(subResults$mseBase/subResults$mseBayesCorr)
dim(subResults)
mean(subResults$mseBayes<subResults$mseBase)
mean(subResults$mseBayes<subResults$mseCombMint)
mean(subResults$mseBayesCorr<subResults$mseCombMint)
median(subResults$mseBayesCorr/subResults$mseCombMint)
summary(subResults$mseBayesCorr/subResults$mseCombMint)
subResults
View(subResults)
boxplot(subResults$mseBayesCorr/subResults$mseCombMint)
boxplot(log(subResults$mseBayesCorr/subResults$mseCombMint))
summary(log(subResults$mseBayesCorr/subResults$mseCombMint))
summary(log(subResults$mseBayes/subResults$mseCombMint))
source('~/switchDrive/paperReconc/hierarchicalTimeSeries/code/hierTs/hierRec.R', echo=TRUE)
hierRec(fmethod = "ets", iTest = 1, synth_n = 200, synthCorrel = 0.5)
hierRec("synthetic",fmethod = "ets", iTest = 1, synth_n = 200, synthCorrel = 0.5)
mseBase
mseCombMint
mseBase
options(digits = 3)
mseBase
mseBayes
mseBayesCorr
mseCombMint
hierRec("synthetic",fmethod = "ets", iTest = 1, synth_n = 200, synthCorrel = 0.5, seed = 1)
mseBase
mseBayes
mseBayesCorr
mseCombMint
mseBase/mseBayes
mseBase/mseBayesCorr
mseCombMint/mseBayesCorr
hierRec("synthetic",fmethod = "ets", iTest = 1, synth_n = 200, synthCorrel = 0.5, seed = 2)
mseBase
mseBayes
mseBayesCorr
mseCombMint
summary(subResults$mseBase)
options(digits = 3)
summary(subResults$mseBase)
summary(subResults$mseBayesCorr)
summary(subResults$mseBayes)
summary(subResults$mseCombMint)
hierRec("synthetic",fmethod = "ets", iTest = 1, synth_n = 200, synthCorrel = 0.5, seed = 56)
mseBase
mseBayes
mseBayesCorr
mseCombMint
hierRec("synthetic",fmethod = "ets", iTest = 1, synth_n = 200, synthCorrel = 0.5, seed = 98)
mseBase
mseBayes
mseBayesCorr
mseCombMint
allts(test)[h,]
preds
fcastCombMint
allts(fcastCombMint)
bayesRecon(correlation=FALSE))^2
bayesRecon(correlation=FALSE)^2
allts(test)[h,]
mean  ( (allts(test)[h,] - bayesRecon(correlation=FALSE))^2 )
(allts(test)[h,] - preds)^2
mean  ( (allts(test)[h,] - preds)^2 )
options(digits = 3)
mean  ( (allts(test)[h,] - preds)^2 )
a<-mean  ( (allts(test)[h,] - preds)^2 )
a
b <- mean  ( (allts(test)[h,] - bayesRecon(correlation=FALSE))^2 )
b
preds
allts(test)[h,]
(allts(test)[h,] - bayesRecon(correlation=FALSE))
(allts(test)[h,] - allts(fcastCombMint)
)
(allts(test)[h,] - allts(preds)
)
(allts(test)[h,] - preds
)
